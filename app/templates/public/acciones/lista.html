
<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="{{url_for('static', filename ='assets/imgs/favicon.png')}}" type="image/x-icon">
    <link rel="stylesheet" href="{{ url_for('static', filename ='assets/css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename ='assets/css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename ='assets/css/tooltip.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename ='assets/css/custom_alert.css') }}">
  </head>
  

<body>
<!-- {{ miData }} -->
{% if (miData) %}
<div class="table-responsive">
    <table class="table table-bordered table-hover">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Marca_1</th>
                <th scope="col">Modelo_2</th>
                <th scope="col">Año_3</th>
                <th scope="col">Foto</th>
                <th scope="col">Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for carro in miData %}
            {% with urlCarro = '/static/assets/fotos_carros/' %}
            <tr id="Registro_{{ carro.id }}">
                <th scope="row">{{ loop.index }}</th>
                <td>{{ carro.marca }}</td>
                <td>{{ carro.modelo }}</td>
                <td>{{ carro.year }}</td>
                <td>
                    {% if(carro.foto !="") %}
                    <img src="{{ urlCarro }}{{ carro.foto }}" class="sin_foto_mini" alt="{{ carro.marca }}">
                    {% else %}
                    <img src="{{ urlCarro }}sin_foto.jpg" class="sin_foto_mini" alt="coche">
                    {% endif %}
                </td>
                <td width="300">
                    <span style="display: flex; justify-content:space-between;">
                        <a href="{{ url_for('viewDetalleCarro', idCarro = carro.id ) }}" type="button"
                            class="btn btn-warning btn-sm" tooltip="Ver Registro">
                  <i class="bi bi-eye"></i>
                </a>

                <a href="{{ url_for('formViewUpdate', id = carro.id ) }}" class="btn btn-success btn-sm" data-bs-toggle="tooltip" title="Actualizar Registro">
                  <i class="bi bi-pencil"></i>
                </a>

                <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="tooltip" title="Eliminar Registro" onclick="eliminarCarroJavaScript('{{ carro.id }}')" data-foto="{{ carro.foto }}" id="id_{{ carro.id }}">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </td>
          </tr>
          {% endwith %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% else %}
<div class="alert alert-info shadow-sm">
  <div class="row mb-3">
    <div class="col-12 text-center">
      <i class="bi bi-exclamation-circle fs-1"></i>
      <h4 class="mt-3">No hay Carros Registrados</h4>
      <p>No se encontraron registros en el sistema.</p>
      <a href="/" class="btn btn-primary mt-2">
        <i class="bi bi-arrow-left me-2"></i>Volver al inicio
      </a>
    </div>
  </div>
</div>
{% endif %}

<script>
  // Función de búsqueda en la tabla
  document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('searchTable');
    if (searchInput) {
      searchInput.addEventListener('keyup', function() {
        const searchTerm = this.value.toLowerCase();
        const rows = document.querySelectorAll('.data-row');
        
        rows.forEach(row => {
          const marca = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
          const modelo = row.querySelector('td:nth-child(3)').textContent.toLowerCase();
          const year = row.querySelector('td:nth-child(4)').textContent.toLowerCase();
          
          if (marca.includes(searchTerm) || modelo.includes(searchTerm) || year.includes(searchTerm)) {
            row.style.display = '';
          } else {
            row.style.display = 'none';
          }
        });
      });
    }
  });
</script>
</div>
{% endblock %}